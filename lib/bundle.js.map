{"version":3,"sources":["webpack:///webpack/bootstrap c94fb980b1770c6e9988","webpack:///./lib/piano_hero.js","webpack:///./lib/game.js","webpack:///./lib/note.js","webpack:///./lib/game_view.js","webpack:///./lib/key_util.js","webpack:///./lib/black_key.js","webpack:///./vendor/sound.js","webpack:///./lib/song.js","webpack:///./lib/util.js","webpack:///./lib/constants.js","webpack:///./lib/white_key.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,EAAC;;;;;;;ACZD;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAmB;AACnB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA,kBAAiB,eAAe;;AAEhC;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;;;;;AC9EA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kEAAiE;AACjE;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAoB,cAAc;AAClC;;AAEA;;;;;;;;ACtEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD;AACjD;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;;AAEA;AACA,kCAAiC;AACjC,iCAAgC;AAChC;AACA;AACA,uBAAsB;AACtB;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;;AAEA;;;;;;;ACxCA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;;;;;AC/BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;;;;;;;ACnCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;;AAEA;;;;;;;ACrDA;;AAEA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;;AAEA;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;ACvBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA","file":"./lib/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap c94fb980b1770c6e9988\n **/","const Game = require('./game');\nconst GameView = require('./game_view');\n\ndocument.addEventListener('DOMContentLoaded', ()=>{\n  const canvasEl = document.getElementById('canvas');\n  const game = new Game('Ode to Joy');\n  canvasEl.height = game.height;\n  canvasEl.width = game.width;\n\n  const ctx = canvasEl.getContext('2d');\n\n  new GameView(game, ctx).start();\n});\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/piano_hero.js\n ** module id = 0\n ** module chunks = 0\n **/","const Note = require('./note');\nconst whiteKey = require('./white_key');\nconst blackKey = require('./black_key');\nconst populateSong = require('./song');\n\nconst NUM_NOTES = 8;\nconst HEIGHT = window.innerHeight;\nconst WIDTH = 1000; // window.innerWidth;\nconst KEY_HEIGHT = 170;\n\nconst Game = function(songName) {\n  this.notes = [];\n  this.whiteKeys = [];\n  this.addNotes(songName);\n  this.addWhiteKeys();\n  this.height = HEIGHT;\n  this.width = WIDTH;\n  this.score = 0;\n};\n\nGame.prototype.addNotes = function(songName) {\n  const that = this;\n  this.notes = populateSong(songName);\n  this.notes.forEach(note => {\n    note.game = that;\n  });\n};\n\nGame.prototype.addWhiteKeys = function() {\n  for (let i = 0; i < NUM_NOTES; i++) {\n\n    this.whiteKeys.push(new whiteKey({\n        pos: [75*i+200, 325],\n        xSize: 70,\n        ySize: KEY_HEIGHT,\n        game: this\n      })\n    );\n  }\n};\n\nGame.prototype.displayScore = function(ctx, score) {\n  ctx.fillStyle = 'white';\n  ctx.fillRect(this.height + 25, this.width - 25, 50, 50);\n  ctx.font=\"20px Georgia\";\n  ctx.fillText(score,10,50);\n};\n\nGame.prototype.draw = function(ctx) {\n  ctx.clearRect(0, 0, this.width, this.height);\n  this.whiteKeys.forEach(key => {\n    key.draw(ctx);\n  });\n  this.notes.forEach(note => {\n    note.draw(ctx);\n  });\n  const bk = new blackKey();\n  bk.draw(ctx);\n  this.displayScore(ctx, this.score);\n};\n\nGame.prototype.move = function(delta) {\n  this.notes.forEach(note => {\n    // this.removeOldNote(note);\n    note.move(delta);\n  });\n};\n\nGame.prototype.removeOldNote = function(note) {\n  if (note.pos[1] > this.height) {\n    this.notes.splice(this.notes.indexOf(note), 1);\n  }\n};\n\nGame.prototype.step = function(delta) {\n  this.move(delta);\n};\n\nmodule.exports = Game;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/game.js\n ** module id = 1\n ** module chunks = 0\n **/","const Sound = require('../vendor/sound');\nconst Util = require('./util');\nconst Constants = require('./constants');\n\nconst defaultOptions = {\n  vel: [0, 3.5],\n  color: Util.randomColor(),\n  xSize: 70,\n  ySize: 70\n};\n\nconst Note = function(options) {\n  Object.assign(defaultOptions, options);\n  this.note = defaultOptions.note;\n  this.pos = defaultOptions.pos;\n  this.vel = defaultOptions.vel;\n  this.color = defaultOptions.color;\n  this.game = defaultOptions.game;\n  this.xSize = defaultOptions.xSize;\n  this.ySize = defaultOptions.ySize;\n  this.id = defaultOptions.id;\n  this.glowing = false;\n  this.duration = defaultOptions.duration;\n};\n\nNote.prototype.draw = function(ctx) {\n  ctx.shadowColor = \"transparent\";\n  ctx.fillStyle = this.color;\n  ctx.fillRect(this.pos[0], this.pos[1], this.xSize, this.ySize); //fillRect(x, y, width, height)\n  if (this.glowing) {\n    ctx.shadowBlur = 50;\n    ctx.shadowColor = \"blue\";\n    ctx.fillRect(this.pos[0], this.pos[1], this.xSize, this.ySize);\n  }\n};\n\nconst NORMAL_FRAME_TIME_DELTA = 1000/60;\nNote.prototype.move = function (timeDelta) {\n  //timeDelta - milliseconds since last move\n  //if computer is busy, timeDelta will be larger\n  //and note should move farther in that frame\n  //vel is how far note should move in 1/60th of a second\n  let velocityScale = timeDelta / NORMAL_FRAME_TIME_DELTA,\n      offsetX = this.vel[0] * velocityScale,\n      offsetY = this.vel[1] * velocityScale;\n\n  this.pos = [this.pos[0] + offsetX, this.pos[1] + offsetY];\n};\n\nNote.prototype.remove = function () {\n  this.game.notes.splice(this.game.notes.indexOf(this), 1);\n};\n\nNote.prototype.overlapsTile = function() {\n  const noteCenter = this.pos[1] + (((this.pos[1] + this.ySize) - this.pos[1])/2);\n  const keyTop = this.game.height - this.game.whiteKeys[0].ySize;\n  if ((keyTop < noteCenter) &&\n        (noteCenter < (this.game.height))) {\n          return true;\n    }\n    return false;\n  };\n\nNote.prototype.play = function(timeout) {\n  const freq = Constants.TONES[this.note];\n  const sound = new Sound(freq);\n  sound.start();\n  setTimeout(() => {sound.stop();}, timeout);\n};\n\nmodule.exports = Note;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/note.js\n ** module id = 2\n ** module chunks = 0\n **/","const KeyUtil = require('./key_util');\n\nconst GameView = function(game, ctx) {\n  this.game = game;\n  this.ctx = ctx;\n};\n\nGameView.prototype.bindKeyHandlers = function() {\n  //  The keymaster library will expose a global method key\n  // which takes a key and a callback that will be triggered\n  // when the key is pressed\n  KeyUtil.allKeys().forEach(k => {\n    key(k, KeyUtil.noteHit.bind(this, k, this.game));\n  });\n};\n\nGameView.prototype.start = function() {\n  if (this.game.notes.length === 0) {\n    return;\n  }\n  this.bindKeyHandlers();\n  this.lastTime = 0;\n  requestAnimationFrame(this.animate.bind(this)); // start animating\n};\n\nGameView.prototype.animate = function(time) {\n  if (this.game.notes.length === 0) {\n    return;\n  }\n  this.game.draw(this.ctx);\n\n  let timeDelta = time - this.lastTime;\n\n  this.game.step(timeDelta);\n  this.game.draw(this.ctx);\n  this.lastTime = time;\n\n  requestAnimationFrame(this.animate.bind(this));\n};\n\nmodule.exports = GameView;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/game_view.js\n ** module id = 4\n ** module chunks = 0\n **/","const KEYBOARD_MAPPING = {\n  \"a\": \"C\",\n  \"s\": \"D\",\n  \"d\": \"E\",\n  \"f\": \"F\",\n  \"j\": \"G\",\n  \"k\": \"A\",\n  \"l\": \"B\",\n  \";\": \"C6\"\n};\n\nfunction findAndPlayNote(game, noteName, ctx) {\n  let wrongNotes = 0;\n  let rightNotes = 0;\n\n  game.notes.forEach( note => {\n    if (note.note === noteName) { // if you hit the right note\n      if (note.overlapsTile()) { // and the note is in the right place\n        note.glowing = true;\n        note.play(note.duration);\n        note.remove(); // eventually note.shatter or something?\n        rightNotes += 1;\n      } else {\n        wrongNotes += 1;\n      }\n    }\n    game.score = rightNotes - wrongNotes;\n  });\n}\n\nconst KeyUtil = {\n  noteHit(key, game) {\n    const noteName = KEYBOARD_MAPPING[key];\n    findAndPlayNote(game, noteName);\n  },\n  allKeys() {\n    return Object.keys(KEYBOARD_MAPPING);\n  },\n};\n\nmodule.exports = KeyUtil;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/key_util.js\n ** module id = 5\n ** module chunks = 0\n **/","const blackKey = function() {\n\n};\n\nblackKey.prototype.draw = function(ctx) {\n  ctx.shadowColor = \"transparent\";\n\n  //fake white keys\n  ctx.fillStyle = 'white';\n  ctx.fillRect(125, 325, 70, 170);\n  ctx.fillRect(50, 325, 70, 170);\n  ctx.fillRect(-25, 325, 70, 170);\n  ctx.fillRect(800, 325, 70, 170);\n  ctx.fillRect(875, 325, 70, 170);\n  ctx.fillRect(950, 325, 70, 170);\n\n  ctx.fillStyle = 'black';\n  // fake black keys\n  // x, y, width, height\n  ctx.fillRect(30, 324, 35, 120);\n  ctx.fillRect(105, 324, 35, 120);\n  ctx.fillRect(255, 324, 35, 120);\n  ctx.fillRect(330, 324, 35, 120);\n  ctx.fillRect(480, 324, 35, 120);\n  ctx.fillRect(555, 324, 35, 120);\n  ctx.fillRect(630, 324, 35, 120);\n  ctx.fillRect(780, 324, 35, 120);\n  ctx.fillRect(855, 324, 35, 120);\n\n};\n\nmodule.exports = blackKey;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/black_key.js\n ** module id = 6\n ** module chunks = 0\n **/","const ctx = new (window.AudioContext || window.webkitAudioContext)();\n\nconst createOscillator = freq => {\n  const osc = ctx.createOscillator();\n  osc.type = \"sine\";\n  osc.frequency.value = freq;\n  osc.detune.value = 0;\n  osc.start(ctx.currentTime);\n  return osc;\n};\n\nconst createGainNode = () => {\n  const gainNode = ctx.createGain();\n  gainNode.gain.value = 0;\n  gainNode.connect(ctx.destination);\n  return gainNode;\n};\n\nfunction Sound(freq) {\n    this.oscillatorNode = createOscillator(freq);\n    this.gainNode = createGainNode();\n    this.oscillatorNode.connect(this.gainNode);\n}\n\nSound.prototype = {\n  start() {\n    // can't explain 0.3, it is a reasonable value\n    this.gainNode.gain.value = 0.3;\n  },\n\n  stop() {\n    this.gainNode.gain.value = 0;\n  }\n};\n\nmodule.exports = Sound;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./vendor/sound.js\n ** module id = 7\n ** module chunks = 0\n **/","const Note = require('./note');\n\nconst PIXEL_MAPPING = {\n  'C': 200,\n  'D': 275,\n  'E': 350,\n  'F': 425,\n  'G': 500,\n  'A': 575,\n  'B': 650,\n  'C6': 725\n};\n\nconst odeToJoy = 'EEFGGFEDCCDEEDDEEFGGFEDCCDEDCC';\nconst LionSleepsTonight = 'CDEDEFEDCDEDCEDGFEFGFEDCDEDCED';\n\nconst SONG_MAPPING = {\n  'Ode to Joy': odeToJoy,\n  'The Lion Sleeps Tonight': LionSleepsTonight\n};\n\nconst populateSong = function(songName) {\n  const allNotes = SONG_MAPPING[songName];\n  const notes = allNotes.split('');\n  let song = [];\n  let offset = 0;\n  for (let i = 0; i < notes.length; i++) {\n    if (i === 12 || i === 14 || i === 27 || i === 29) {\n      song.push(new Note({\n        id: i + 1,\n        note: notes[i],\n        pos: [PIXEL_MAPPING[notes[i]], (-100*i - 50 - offset)],\n        vel: [0, 3.5],\n        duration: 1000,\n        ySize: 140\n      }));\n      offset = offset + 100;\n    } else {\n      song.push(new Note({\n        id: i + 1,\n        note: notes[i],\n        pos: [PIXEL_MAPPING[notes[i]], (-100*i - offset)],\n        vel: [0, 3.5],\n        xSize: 70,\n        ySize: 70,\n        duration: 500\n      }));\n    }\n  }\n\n  return song;\n};\n\nmodule.exports = populateSong;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/song.js\n ** module id = 8\n ** module chunks = 0\n **/","const HEX_DIGITS = \"0123456789ABCDEF\";\n\nconst Util = {\n  randomColor() {\n    let color = \"#\";\n    for (let i = 0; i < 6; i++) {\n      color += HEX_DIGITS[Math.floor((Math.random() * 16))];\n    }\n    return color;\n  }\n};\n\nmodule.exports = Util;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/util.js\n ** module id = 9\n ** module chunks = 0\n **/","const Constants = {\n  // KEY_MAPPINGS: {\n  //   0: 'C5',\n  //   1: 'D5',\n  //   2: 'E5',\n  //   3: 'F5',\n  //   4: 'G5',\n  //   5: 'A5',\n  //   6: 'B5',\n  //   7: 'C6'\n  // },\n  TONES: {\n    'C': 523.25,\n    'D': 587.33,\n    'E': 659.25,\n    'F': 698.46,\n    'G': 783.99,\n    'A': 880.00,\n    'B': 987.77,\n    'C6': 1046.50\n  }\n};\n\nmodule.exports = Constants;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/constants.js\n ** module id = 10\n ** module chunks = 0\n **/","const whiteKey = function(options) {\n  this.pos = options.pos;\n  this.xSize = options.xSize;\n  this.ySize = options.ySize;\n};\n\nwhiteKey.prototype.draw = function(ctx) {\n  ctx.shadowColor = 'transparent';\n  ctx.fillStyle = 'white';\n  ctx.fillRect(this.pos[0], this.pos[1], this.xSize, this.ySize);\n};\n\nmodule.exports = whiteKey;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/white_key.js\n ** module id = 11\n ** module chunks = 0\n **/"],"sourceRoot":""}